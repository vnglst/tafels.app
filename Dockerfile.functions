FROM node:22-alpine

# Add non-root user
RUN addgroup -S appgroup && adduser -S appuser -G appgroup

WORKDIR /app
COPY functions/package.json functions/
WORKDIR /app/functions
RUN yarn install --frozen-lockfile --production

COPY functions/bigheads.js .

# Use non-root user
USER appuser

EXPOSE 9000
CMD ["node", "bigheads.js"]